# λ°μ΄ν„° μ•”νΈν™” κΈ°λ° κ²€μƒ‰ μµμ ν™” μ—°κµ¬ ν”„λ΅μ νΈ

## λ„μ… λ°°κ²½

μµκ·Ό SKT, μ•λ°”λ¬ λ“± κµ­λ‚΄ λ€κΈ°μ—… λ° μ£Όμ” μ„λΉ„μ¤ κΈ°μ—…λ“¤μ΄ μ—°μ΄μ–΄ **DB μ μ¶ μ‚¬κ³ **λ¥Ό κ²κ³  μμµλ‹λ‹¤. μ΄μ²λΌ λ°μ΄ν„°λ² μ΄μ¤μ— μ €μ¥λ λ―Όκ°ν• κ°μΈμ •λ³΄κ°€ μ™Έλ¶€ κ³µκ²©μΌλ΅ μΈν•΄ μ μ¶λ  κ²½μ° κΈ°μ—…μ μ‹ λΆ°λ„ λ° μ‚¬μ©μ λ³΄μ•μ— λ§‰λ€ν• μν–¥μ„ λ―ΈμΉκ² λ©λ‹λ‹¤.

μ΄λ¬ν• ν„μ‹¤μ„ λ°μν•μ—¬, **DB λ‚΄ λ―Όκ° μ •λ³΄ μ•”νΈν™”λ” μ„ νƒμ΄ μ•„λ‹ ν•„μ**κ°€ λμ—μµλ‹λ‹¤.

ν•μ§€λ§ λ°μ΄ν„°λ¥Ό μ•”νΈν™”ν•μ—¬ μ €μ¥ν•λ” κ²ƒμ€ κ°„λ‹¨ν•΄ λ³΄μ—¬λ„, μ‹¤λ¬΄μ—μ„λ” μ‹¬κ°ν• λ¬Έμ λ¥Ό μ λ°ν•©λ‹λ‹¤. κ·Έ μ¤‘ λ€ν‘μ μΈ κ²ƒμ΄ λ°”λ΅ **"κ²€μƒ‰ λ¶κ°€λ¥ λ¬Έμ "**μ…λ‹λ‹¤. λ¨λ“  λ°μ΄ν„°λ¥Ό μ•”νΈν™”ν•λ©΄, μΌλ°μ μΈ WHERE μ΅°κ±΄μ΄λ‚ LIKE κ²€μƒ‰μ΄ μ λ€λ΅ λ™μ‘ν•μ§€ μ•κΈ° λ•λ¬Έμ— μ•”νΈν™”κ°€ μ¤νλ ¤ μ„λΉ„μ¤ κΈ°λ¥μ„ μ ν•ν•κ² λ©λ‹λ‹¤.

λ³Έ ν”„λ΅μ νΈλ” **κ°μΈμ •λ³΄λ¥Ό μ•”νΈν™”ν•μ—¬ μ•μ „ν•κ² μ €μ¥ν•λ©΄μ„λ„**, **μ‹¤μ‹κ°„ κ²€μƒ‰μ΄ κ°€λ¥ν• κµ¬μ΅°λ¥Ό μ–΄λ–»κ² κµ¬ν„ν•  μ μμ„μ§€λ¥Ό μ—°κµ¬ν•λ” ν”„λ΅μ νΈ**μ…λ‹λ‹¤.

## 1. DB λ°μ΄ν„° μ•”νΈν™” λ°©μ‹ μ •λ¦¬

| λ¶„λ¥ | λ°©μ‹ | νΉμ§• | κ²€μƒ‰ κ°€λ¥μ„± | μ‹¤λ¬΄ ν™μ© |
|------|------|------|------------|----------|
| β… λ€μΉ­ν‚¤ μ•”νΈν™” | AES-256 λ“± | λ³µνΈν™” κ°€λ¥, κ°•λ ¥ν• λ³΄μ• | β μ§μ ‘ κ²€μƒ‰ λ¶κ°€ | β… κ°μΈμ •λ³΄ μ €μ¥μ© |
| β… ν•΄μ‹ν•¨μ | SHA-256 λ“± | λΉ„κ°€μ—­μ , μΌμΉ λΉ„κµλ§ κ°€λ¥ | β… μ™„μ „ μΌμΉλ§ κ°€λ¥ | β… μ „ν™”λ²νΈ/μ£Όλ―Όλ²νΈ λ“± |
| β›” λΉ„λ€μΉ­ν‚¤ μ•”νΈν™” | RSA λ“± | λλ¦¬κ³  ν‚¤ κ΄€λ¦¬ λ³µμ΅ | β κ²€μƒ‰ λ¶κ°€ | β κ²€μƒ‰μ—”μ§„μ—λ” λ¶€μ ν•© |
| β  λ™ν•μ•”νΈ | Paillier λ“± | μ•”νΈν™” μƒνƒλ΅ μ—°μ‚° κ°€λ¥ | β  κ°€λ¥ν•λ‚ λ§¤μ° λλ¦Ό | β μ‹¤λ¬΄ μ μ© μ–΄λ ¤μ›€ |
| β  κ²€μƒ‰ κ°€λ¥ν• μ•”νΈν™” | Order-Preserving Encryption λ“± | λ¶€λ¶„ κ²€μƒ‰ κ°€λ¥ | β  κ°€λ¥ν•λ‚ λ³΄μ• μ·¨μ•½ κ°€λ¥μ„± μμ | β λ§¤μ° μ ν•μ  μ μ© |
| β… κ²°μ •μ  μ•”νΈν™” | HMAC, AES-ECB λ“± | λ™μΌ μ…λ ¥ μ‹ λ™μΌ μ¶λ ¥ | β… λ™λ“± κ²€μƒ‰(equality) κ°€λ¥ | β… μ΄λ¦„, μ΄λ©”μΌ λ“± κ²€μƒ‰ ν•„μ” ν•„λ“ |

## 2. κ²°μ •μ  μ•”νΈν™”(Deterministic Encryption)μ ν™μ©

κ²°μ •μ  μ•”νΈν™”λ” λ™μΌν• ν‰λ¬Έμ΄ ν•­μƒ λ™μΌν• μ•”νΈλ¬ΈμΌλ΅ λ³€ν™λλ” νΉμ„±μ„ κ°€μ§€κ³  μμ–΄, κ²€μƒ‰μ— ν™μ©ν•  μ μμµλ‹λ‹¤:

- **μ¥μ **: μ•”νΈν™”λ μƒνƒμ—μ„λ„ λ™λ“± κ²€μƒ‰(equality search)μ΄ κ°€λ¥
- **λ‹¨μ **: λΉλ„ λ¶„μ„ κ³µκ²©μ— μ·¨μ•½ν•  μ μμ
- **μ μ© μ‚¬λ΅€**: μ΄λ¦„, μ΄λ©”μΌ μ£Όμ† λ“± λ™λ“± κ²€μƒ‰μ΄ ν•„μ”ν• ν•„λ“μ— ν™μ©
- **κµ¬ν„ λ°©μ‹**:
    - AES-ECB λ¨λ“ (λ³΄μ•μ— μ·¨μ•½ν•  μ μμ)
    - AES-CBC λ¨λ“ + κ³ μ • IV (λ” μ•μ „ν• λ°©μ‹)
    - HMAC κΈ°λ° κµ¬ν„ (SHA-256 λ“± ν•΄μ‹ ν•¨μ ν™μ©)

## 3. μ‹¤λ¬΄ ν™κ²½μ—μ„ λ§μ΄ μ“°λ” κµ¬μ΅°

1. **ν•„λ“λ³„ μ°¨λ“± λ³΄νΈ μ „λµ**
    - κ°μΈμ •λ³΄ ν•„λ“λ§λ‹¤ λ―Όκ°λ„μ™€ κ²€μƒ‰ ν•„μ”μ„±μ— λ”°λΌ λ‹¤λ¥Έ μ•”νΈν™” λ°©μ‹ μ μ©
        * **μ΄λ¦„**: κ²°μ •μ  μ•”νΈν™” λλ” ν¬λ„¤ν‹± κ²€μƒ‰ μΈλ±μ¤ λ³‘ν–‰
        * **μ „ν™”λ²νΈ**: λ§μ¤ν‚Ή + λ¶€λ¶„ μ•”νΈν™” (λ’·μλ¦¬λ§ κ°•ν• μ•”νΈν™”)
        * **μ£Όμ†**: κ³„μΈµλ³„ λ³΄νΈ (μ‹/λ„λ” ν‰λ¬Έ, μƒμ„Έμ£Όμ†λ” μ•”νΈν™”)

2. **ν† ν°ν™”(Tokenization) λ°©μ‹**
    - λ―Όκ°ν• λ°μ΄ν„°λ¥Ό μλ―Έ μ—†λ” ν† ν°μΌλ΅ λ€μ²΄
    - μ›λ³Έ λ°μ΄ν„°μ™€ ν† ν° κ°„μ λ§¤ν•‘μ€ λ³„λ„ λ³΄μ• μ‹μ¤ν…μ—μ„ κ΄€λ¦¬
    - κ²€μƒ‰μ€ ν† ν°μΌλ΅ μν–‰, ν‘μ‹ν•  λ•λ§ μ›λ³Έ λ³µμ›

3. **κ²€μƒ‰ μµμ ν™” κµ¬μ΅°**
    - AES-256 λ“±μΌλ΅ κ°μΈμ •λ³΄ μ•”νΈν™” μ €μ¥ (λ³µνΈν™” κ°€λ¥)
    - κ²€μƒ‰μ©μΌλ΅λ” λ§μ¤ν‚Ή ν•„λ“/ν† ν°ν™”λ ν•„λ“λ¥Ό λ³„λ„λ΅ μ €μ¥ν•μ—¬ μ‚¬μ©
    - Elasticsearch λ“± μ™Έλ¶€ κ²€μƒ‰μ—”μ§„μ— κ°€λ…ν™”λ μ •λ³΄λ§ μƒ‰μΈ
    - κ²€μƒ‰ κ²°κ³Όμ—μ„ IDλ¥Ό κΈ°μ¤€μΌλ΅ DBμ—μ„ λ³µνΈν™”ν•μ—¬ μ‘λ‹µ

4. **λ°μ΄ν„° μ ν•λ³„ μ‹¤μ  κµ¬ν„ μμ‹**

   ```
   μ΄λ¦„ μ²λ¦¬:
   - μ›λ³Έ μ΄λ¦„ "ν™κΈΈλ™" β†’ μ•”νΈν™”ν•μ—¬ μ €μ¥ (AES-256 λ“±μΌλ΅)
   - κ²€μƒ‰μ© μΈλ±μ¤: κ²°μ •μ  μ•”νΈν™”λ κ°’ (HMAC-SHA256 λ“±)
   - λλ” μ΄μ„± μΈλ±μ¤ "γ…γ„±γ„·"μ„ λ³„λ„ μ»¬λΌμ— μ €μ¥
   
   μ „ν™”λ²νΈ μ²λ¦¬:
   - μ „μ²΄ λ²νΈλ” κ°•ν• μ•”νΈν™” (AES-GCM λ“±)
   - κµ­λ²(μ• μλ¦¬)μ€ κ²°μ •μ  μ•”νΈν™”ν•μ—¬ μ§€μ—­λ³„ κ²€μƒ‰ κ°€λ¥
   - κ²€μƒ‰ μ‹: μ…λ ¥λ μ „ν™”λ²νΈμ— λ™μΌν• μ²λ¦¬λ¥Ό μ μ©ν•μ—¬ κ²€μƒ‰
   
   μ£Όμ† μ²λ¦¬:
   - μ£Όμ†λ¥Ό κµ¬μ„±μ”μ†λ³„λ΅ λ¶„λ¦¬: μ‹/λ„, κµ¬/κµ°, μƒμ„Έμ£Όμ†
   - μ‹/λ„, κµ¬/κµ°μ€ ν‰λ¬Έ λλ” κ²°μ •μ  μ•”νΈν™”
   - μƒμ„Έμ£Όμ†λ” κ°•ν• μ•”νΈν™”
   - κ²€μƒ‰μ© μ§€μ—­ μ½”λ“ ν•„λ“ μ¶”κ°€
   ```

## 4. DB μ„ νƒ μ‹ κ³ λ ¤ μ‚¬ν•­

| κΈ°μ¤€ | μ„¤λ… |
|------|------|
| β… μ €μ¥ μ•”νΈν™” μ§€μ› | μ»¬λΌ μμ¤€ μ•”νΈν™” λλ” μ•”νΈν™”λ ν•„λ“ μ €μ¥ κµ¬μ΅° μ§€μ› |
| β… μΈλ±μ¤ μ„¤μ • μ μ—°μ„± | κ²€μƒ‰μ© ν•„λ“λ¥Ό λ”°λ΅ κ΄€λ¦¬ν•  μ μλ„λ΅ μΈλ±μ¤ κµ¬μ΅° μ μ—°ν•΄μ•Ό ν•¨ |
| β… μ™Έλ¶€ κ²€μƒ‰ μ—°λ™μ„± | Elasticsearch λ“± κ²€μƒ‰ μ‹μ¤ν…κ³Ό μ—°λ™μ΄ μμ›”ν•΄μ•Ό ν•¨ |
| β… μ„±λ¥ | λ³µνΈν™”λ‚ μ „μ²΄ μ¤μΊ”μ΄ λ§κΈ° λ•λ¬Έμ— IO μ„±λ¥ μ¤‘μ” |
| β… ν‚¤ κ΄€λ¦¬ κµ¬μ΅° | μ•”νΈν™” ν‚¤λ¥Ό μ•μ „ν•κ² κ΄€λ¦¬ν•  μ μλ” μ‹μ¤ν…μ΄ ν•„μ” (μ: AWS KMS, Hashicorp Vault λ“±) |

### π” **μ¶”μ² DB μμ‹**:
* **RDB**: PostgreSQL (μ•”νΈν™” κΈ°λ¥, JSON κµ¬μ΅° μ €μ¥ λ“± ν™μ© κ°€λ¥)
* **NoSQL**: MongoDB (ν•„λ“ μ•”νΈν™” + μ μ—°ν• μΈλ±μ‹±)
* **κ²€μƒ‰μ—”μ§„**: Elasticsearch (κ°€λ…ν™”λ λ°μ΄ν„° μƒ‰μΈ μ©λ„)

## 5. μ΄μ¤‘ μ €μ¥ λ°©μ‹μ— λ€ν• λ³΄μ• κ³ λ ¤μ‚¬ν•­

μ΄μ¤‘ μ €μ¥ λ°©μ‹μ€ λ§μ΄ μ‚¬μ©λμ§€λ§ λ‹¤μκ³Ό κ°™μ€ λ³΄μ• μ„ν—μ΄ μμµλ‹λ‹¤:

1. **μ„ν—μ„±**: μ›λ³Έ λ°μ΄ν„°μ™€ κ²€μƒ‰μ© λ°μ΄ν„°κ°€ λ¨λ‘ μ μ¶λ  κ²½μ° λ³΄μ• ν¨κ³Όκ°€ κ°μ†
2. **λ€μ• μ ‘κ·Όλ²•**:
    - λ¬Όλ¦¬μ  λ¶„λ¦¬: κ²€μƒ‰μ© μΈλ±μ¤μ™€ μ›λ³Έ λ°μ΄ν„°λ¥Ό λ‹¤λ¥Έ μ„λ²„/DBμ— μ €μ¥
    - μ ‘κ·Ό μ μ–΄ κ°•ν™”: κ²€μƒ‰μ© λ°μ΄ν„°μ— λ€ν• μ ‘κ·Ό κ¶ν• μ ν•
    - κ°€λ…ν™” μμ¤€ ν–¥μƒ: κ²€μƒ‰μ© λ°μ΄ν„°λ¥Ό μµλ€ν• κ°€λ…ν™”ν•μ—¬ μ›λ³Έ μ‹λ³„ μ–΄λ µκ² ν•¨

## 6. μ•”νΈν™” ν‚¤ κ΄€λ¦¬ μ „λµ

1. **ν‚¤ κ΄€λ¦¬ μ‹μ¤ν… (KMS)**
    - AWS KMS, HashiCorp Vault, Google Cloud KMS λ“± ν™μ©
    - ν‚¤λ” DBμ™€ λ°λ“μ‹ λ¶„λ¦¬ν•μ—¬ κ΄€λ¦¬

2. **ν‚¤ μν™ (Key Rotation)**
    - μ •κΈ°μ μΈ ν‚¤ λ³€κ²½μΌλ΅ ν‚¤ μ μ¶ μ‹ ν”Όν•΄ μµμ†ν™”
    - μν™ μ£ΌκΈ°: λ¶„κΈ°, λ°κΈ°, 1λ…„ λ“± μ •μ±…μ— λ”°λΌ μ„¤μ •

3. **λ§μ¤ν„° ν‚¤μ™€ λ°μ΄ν„° ν‚¤ λ¶„λ¦¬**
    - λ§μ¤ν„° ν‚¤: λ°μ΄ν„° ν‚¤λ¥Ό μ•”νΈν™”ν•λ” μ©λ„
    - λ°μ΄ν„° ν‚¤: μ‹¤μ  λ°μ΄ν„° μ•”νΈν™”μ— μ‚¬μ©

## 7. ν…μ¤νΈ λ° λ²¤μΉλ§ν‚Ή κ³„ν

1. **μ„±λ¥ ν…μ¤νΈ**
    - λ‹¤μ–‘ν• μ•”νΈν™” λ°©μ‹λ³„ μ•”/λ³µνΈν™” μ†λ„ λΉ„κµ
    - κ²€μƒ‰ μ„±λ¥ μΈ΅μ • (TPS, μ‘λ‹µμ‹κ°„)
    - λ€μ©λ‰ λ°μ΄ν„°μ…‹(100λ§ κ±΄ μ΄μƒ)μ—μ„μ μ„±λ¥ κ²€μ¦

2. **λ³΄μ•μ„± ν…μ¤νΈ**
    - μ•”νΈν™”λ λ°μ΄ν„°μ— λ€ν• λΉλ„ λ¶„μ„ κ³µκ²© μ‹λ®¬λ μ΄μ…
    - ν‚¤ μ μ¶ μ‹λ‚λ¦¬μ¤μ— λ”°λ¥Έ μ„ν— ν‰κ°€
    - λ°μ΄ν„° λ³µκµ¬ κ°€λ¥μ„± κ²€μ¦

## 8. κΈ°μ  κ²€ν†  κ³Όμ • κΈ°λ΅

λ³Έ ν”„λ΅μ νΈλ¥Ό μ§„ν–‰ν•λ©΄μ„ λ‹¤μ–‘ν• μ•”νΈν™” λ° κ²€μƒ‰ κΈ°μ μ— λ€ν• κ²€ν† κ°€ μ΄λ£¨μ–΄μ΅μµλ‹λ‹¤. μ•„λλ” ν•µμ‹¬ λ…Όμ μ‚¬ν•­μ„ μ”μ•½ν• κ²ƒμ…λ‹λ‹¤.

### κ²°μ •μ  μ•”νΈν™”(Deterministic Encryption) λ¶„μ„

κ²°μ •μ  μ•”νΈν™”λ” λ™μΌν• μ…λ ¥ κ°’(ν‰λ¬Έ)μ— λ€ν•΄ ν•­μƒ λ™μΌν• μ•”νΈν™” κ²°κ³Ό(μ•”νΈλ¬Έ)λ¥Ό μƒμ„±ν•λ” λ°©μ‹μΌλ΅, κ²€μƒ‰ κΈ°λ¥ κµ¬ν„μ— λ§¤μ° μ μ©ν•©λ‹λ‹¤.

#### κ²°μ •μ  μ•”νΈν™”μ μ£Όμ” νΉμ§•:

- **μΌκ΄€μ„±**: λ™μΌν• ν‰λ¬Έμ€ ν•­μƒ λ™μΌν• μ•”νΈλ¬ΈμΌλ΅ λ³€ν™
- **λ™λ“±μ„± κ²€μƒ‰ κ°€λ¥**: μ•”νΈν™”λ μƒνƒμ—μ„λ„ κ°’μ λ™λ“±μ„±(equality) λΉ„κµκ°€ κ°€λ¥
- **λ³΄μ• μμ¤€**: ν™•λ¥ μ  μ•”νΈν™”λ³΄λ‹¤λ” λ³΄μ• μμ¤€μ΄ λ‚®μ (λΉλ„ λ¶„μ„ κ³µκ²©μ— μ·¨μ•½)

#### κ²°μ •μ  μ•”νΈν™”μ κµ¬ν„ λ°©μ‹:

- **λΈ”λ΅ μ•”νΈν™” λ¨λ“**: ECB λ¨λ“(λ³΄μ• μ·¨μ•½) λλ” CBC λ¨λ“ + κ³ μ • IV
- **ν‚¤ νμƒ**: HMAC, PBKDF2μ™€ κ°™μ€ ν‚¤ νμƒ ν•¨μ μ‚¬μ©
- **μ•”νΈν™” ν•¨μ μ΅°ν•©**: AESμ™€ κ°™μ€ λΈ”λ΅ μ•”νΈν™” μ•κ³ λ¦¬μ¦ + μ μ ν• ν¨λ”©

#### λ³΄μ• κ°•ν™” λ°©λ²•:

- **μ†”ν…(Salting)**: κ³ μ  μ‹λ³„μλ¥Ό μ¶”κ°€ν•μ—¬ λ™μΌ κ°’λ„ λ‹¤λ¥Έ μ•”νΈλ¬Έμ΄ λλ„λ΅ ν•¨
- **μ•΅μ„Έμ¤ μ μ–΄**: μ•”νΈν™”λ λ°μ΄ν„°μ— λ€ν• μ ‘κ·Ό κ¶ν• μ—„κ²©ν μ ν•
- **μ¶”κ°€ μ•”νΈν™” κ³„μΈµ**: μ „μ²΄ λ°μ΄ν„°λ² μ΄μ¤ λλ” ν…μ΄λΈ” μμ¤€μ—μ„ μ¶”κ°€ μ•”νΈν™” μ μ©

### ν„μ—…μ—μ„ μ‚¬μ©λλ” μ•”νΈν™” λ° κ²€μƒ‰ λ°©μ‹ λ¶„μ„

λ‹¤μ–‘ν• μ„λΉ„μ¤ ν™κ²½μ—μ„ μ‹¤μ λ΅ μ‚¬μ©λλ” μ•”νΈν™” λ° κ²€μƒ‰ λ°©μ‹μ„ λ¶„μ„ν• κ²°κ³Ό, λ‹¤μκ³Ό κ°™μ€ μ ‘κ·Όλ²•μ΄ λ§μ΄ μ‚¬μ©λκ³  μμµλ‹λ‹¤:

1. **ν•„λ“λ³„ μ°¨λ“± λ³΄νΈ μ „λµ**:
    - μ΄λ¦„: κ²°μ •μ  μ•”νΈν™” λλ” ν¬λ„¤ν‹± κ²€μƒ‰ μΈλ±μ¤ λ³‘ν–‰
    - μ „ν™”λ²νΈ: λ§μ¤ν‚Ή + λ¶€λ¶„ μ•”νΈν™” (λ’·μλ¦¬λ§ κ°•ν• μ•”νΈν™”)
    - μ£Όμ†: κ³„μΈµλ³„ λ³΄νΈ (μ‹/λ„λ” ν‰λ¬Έ, μƒμ„Έμ£Όμ†λ” μ•”νΈν™”)

2. **λ°μ΄ν„° μ ν•λ³„ μ‹¤μ  μ²λ¦¬ λ°©μ‹**:
    - μ΄λ¦„ κ²€μƒ‰: κ²°μ •μ  μ•”νΈν™” λλ” μ΄μ„± μΈλ±μ¤ ν™μ©
    - μ „ν™”λ²νΈ κ²€μƒ‰: κµ­λ² κΈ°λ° κ²€μƒ‰ + λ§μ¤ν‚Ήλ λ’·μλ¦¬
    - μ£Όμ† κ²€μƒ‰: κµ¬μ„±μ”μ†λ³„ λ¶„λ¦¬ μ²λ¦¬ + μ§€μ—­ μ½”λ“ μΈλ±μ‹±

3. **μ—…κ³„λ³„ μ£Όμ” μ‚¬μ© κΈ°μ **:
    - κΈμµκ¶/λ€κΈ°μ—…: μƒμ© μ»¬λΌ μ•”νΈν™” μ†”λ£¨μ…, μμ²΄ EKMS, Oracle TDE
    - μ¤‘κ²¬/μ¤‘μ†κΈ°μ—…: μ• ν”λ¦¬μΌ€μ΄μ… λ λ²¨ μ•”νΈν™” + κ²€μƒ‰μ© μΈλ±μ¤, ν΄λΌμ°λ“ KMS
    - μ¤νƒ€νΈμ—…: Firebase λ³΄μ• κΈ°λ¥, μ• ν”λ¦¬μΌ€μ΄μ… λ λ²¨ μ•”νΈν™” + κ²€μƒ‰μ© ν•„λ“

### μ΄μ¤‘ μ €μ¥ λ°©μ‹μ ν•κ³„ λ¶„μ„

μ΄μ¤‘ μ €μ¥ λ°©μ‹(μ›λ³Έ λ°μ΄ν„°λ” κ°•ν•κ² μ•”νΈν™”ν•κ³  κ²€μƒ‰μ© λ°μ΄ν„°λ” λ³„λ„ μ €μ¥)μ λ³΄μ• μ„ν—μ„±μ„ κ²€ν† ν• κ²°κ³Ό:

- μ–‘μ½ λ°μ΄ν„° λ¨λ‘ μ μ¶ μ‹ λ³΄μ• ν¨κ³Όκ°€ ν¬κ² κ°μ†ν•λ” λ¬Έμ  ν™•μΈ
- λ¬Όλ¦¬μ  λ¶„λ¦¬, μ ‘κ·Ό μ μ–΄ κ°•ν™”, λ” λ†’μ€ μμ¤€μ κ°€λ…ν™” λ“± λ€μ• μ ‘κ·Όλ²• ν•„μ”μ„± λ„μ¶
- λ¨λ“  λ°μ΄ν„°μ— λ€ν•΄ μ΄μ¤‘ μ €μ¥μ„ μ μ©ν•κΈ°λ³΄λ‹¤ λ―Όκ°λ„μ— λ”°λ¥Έ μ„ λ³„μ  μ μ© κ¶μ¥

### ν–¥ν›„ μ—°κµ¬ λ°©ν–¥ λ„μ¶

1. μ‹¤μ‹κ°„ κ²€μƒ‰μ΄ κ°€λ¥ν•λ©΄μ„λ„ λ³΄μ•μ„±μ„ μ μ§€ν•  μ μλ” ν•μ΄λΈλ¦¬λ“ μ ‘κ·Όλ²• κ°λ°
2. λΈ”λ£Έ ν•„ν„°μ™€ κ°™μ€ ν™•λ¥ μ  λ°μ΄ν„° κµ¬μ΅°λ¥Ό ν™μ©ν• μ•”νΈν™” κ²€μƒ‰ μµμ ν™” λ°©μ• μ—°κµ¬
3. λ¨λ°”μΌ/λ¶„μ‚° ν™κ²½μ—μ„μ μ•”νΈν™” ν‚¤ κ΄€λ¦¬ μ „λµ μλ¦½
4. λ‹¤μ–‘ν• μ•”νΈν™” λ°©μ‹μ μ„±λ¥ μν–¥ μ •λ‰ μΈ΅μ • λ° λΉ„κµ λ¶„μ„

## 9. μ‹¤μ  κµ¬ν„ μ½”λ“ μμ‹

### Spring Bootμ—μ„μ μ•”νΈν™” μ²λ¦¬ μμ‹

```java
// μ‚¬μ©μ μ •λ³΄ μ €μ¥ μ‹
@Service
public class UserService {
    @Autowired
    private EncryptionService encryptionService;
    @Autowired
    private UserRepository userRepository;
    
    public void saveUser(UserDto userDto) {
        User user = new User();
        
        // 1. μ΄λ¦„ μ²λ¦¬
        user.setNameEncrypted(encryptionService.encryptStrongly(userDto.getName()));
        user.setNameSearchable(encryptionService.deterministicEncrypt(userDto.getName()));
        
        // 2. μ „ν™”λ²νΈ μ²λ¦¬
        user.setPhoneEncrypted(encryptionService.encryptStrongly(userDto.getPhone()));
        user.setPhonePrefix(encryptionService.deterministicEncrypt(
            userDto.getPhone().substring(0, 6))); // μ§€μ—­λ²νΈ κ²€μƒ‰μ©
        
        // 3. μ£Όμ† μ²λ¦¬
        Address address = userDto.getAddress();
        user.setRegion(address.getRegion());  // μ‹/λ„ (ν‰λ¬Έ μ μ§€)
        user.setCity(address.getCity());      // κµ¬/κµ° (ν‰λ¬Έ μ μ§€)
        user.setAddressDetailEncrypted(encryptionService.encryptStrongly(address.getDetail()));
        
        userRepository.save(user);
    }
    
    // μ΄λ¦„μΌλ΅ κ²€μƒ‰ μ‹
    public List<UserDto> searchByName(String nameQuery) {
        String searchableNameQuery = encryptionService.deterministicEncrypt(nameQuery);
        List<User> users = userRepository.findByNameSearchable(searchableNameQuery);
        
        return users.stream()
            .map(user -> {
                UserDto dto = new UserDto();
                dto.setName(encryptionService.decrypt(user.getNameEncrypted()));
                dto.setPhone(encryptionService.decrypt(user.getPhoneEncrypted()));
                // λ‹¤λ¥Έ ν•„λ“ μ„¤μ •...
                return dto;
            })
            .collect(Collectors.toList());
    }
}
```

### μ•”νΈν™” μ„λΉ„μ¤ κµ¬ν„ μμ‹

```java
@Service
public class EncryptionService {
    @Value("${encryption.key}")
    private String masterKeyBase64;
    private SecretKey masterKey;
    
    @PostConstruct
    public void init() {
        // λ§μ¤ν„° ν‚¤ μ΄κΈ°ν™”
        byte[] keyBytes = Base64.getDecoder().decode(masterKeyBase64);
        masterKey = new SecretKeySpec(keyBytes, "AES");
    }
    
    // κ°•λ ¥ν• μ•”νΈν™” (AES-GCM)
    public String encryptStrongly(String plaintext) {
        try {
            Cipher cipher = Cipher.getInstance("AES/GCM/NoPadding");
            byte[] iv = generateRandomIv();
            GCMParameterSpec parameterSpec = new GCMParameterSpec(128, iv);
            
            cipher.init(Cipher.ENCRYPT_MODE, masterKey, parameterSpec);
            byte[] encrypted = cipher.doFinal(plaintext.getBytes(StandardCharsets.UTF_8));
            
            // IVμ™€ μ•”νΈν™”λ λ°μ΄ν„° κ²°ν•©
            ByteBuffer byteBuffer = ByteBuffer.allocate(iv.length + encrypted.length);
            byteBuffer.put(iv);
            byteBuffer.put(encrypted);
            
            return Base64.getEncoder().encodeToString(byteBuffer.array());
        } catch (Exception e) {
            throw new RuntimeException("μ•”νΈν™” μ‹¤ν¨", e);
        }
    }
    
    // κ²°μ •μ  μ•”νΈν™” (κ²€μƒ‰μ©)
    public String deterministicEncrypt(String plaintext) {
        try {
            Mac mac = Mac.getInstance("HmacSHA256");
            mac.init(masterKey);
            byte[] result = mac.doFinal(plaintext.getBytes(StandardCharsets.UTF_8));
            return Base64.getEncoder().encodeToString(result);
        } catch (Exception e) {
            throw new RuntimeException("κ²°μ •μ  μ•”νΈν™” μ‹¤ν¨", e);
        }
    }
    
    // λ³µνΈν™”
    public String decrypt(String encryptedBase64) {
        try {
            byte[] encryptedBytes = Base64.getDecoder().decode(encryptedBase64);
            ByteBuffer byteBuffer = ByteBuffer.wrap(encryptedBytes);
            
            byte[] iv = new byte[12]; // GCM λ¨λ“μ IV ν¬κΈ°
            byteBuffer.get(iv);
            
            byte[] cipherText = new byte[byteBuffer.remaining()];
            byteBuffer.get(cipherText);
            
            Cipher cipher = Cipher.getInstance("AES/GCM/NoPadding");
            GCMParameterSpec parameterSpec = new GCMParameterSpec(128, iv);
            cipher.init(Cipher.DECRYPT_MODE, masterKey, parameterSpec);
            
            byte[] decrypted = cipher.doFinal(cipherText);
            return new String(decrypted, StandardCharsets.UTF_8);
        } catch (Exception e) {
            throw new RuntimeException("λ³µνΈν™” μ‹¤ν¨", e);
        }
    }
    
    private byte[] generateRandomIv() {
        byte[] iv = new byte[12]; // GCM λ¨λ“μ— κ¶μ¥λλ” IV ν¬κΈ°
        new SecureRandom().nextBytes(iv);
        return iv;
    }
}
```

## 10. λ³΄μ•κ³Ό κ²€μƒ‰μ„±λ¥ μ‚¬μ΄μ κ· ν• μ „λµ

λ³Έ ν”„λ΅μ νΈλ” μ•”νΈν™”λ΅ μΈν• λ³΄μ• κ°•ν™”μ™€ κ²€μƒ‰ κΈ°λ¥ μ μ§€ μ‚¬μ΄μ—μ„ μµμ μ κ· ν•μ„ μ°Ύλ” κ²ƒμ„ λ©ν‘λ΅ ν•©λ‹λ‹¤. μ΄λ¥Ό μ„ν•΄ λ‹¤μκ³Ό κ°™μ€ μ „λµμ„ κ³ λ ¤ν•κ³  μμµλ‹λ‹¤:

1. **κ³„μΈµμ  λ³΄μ• λ¨λΈ** - λ°μ΄ν„° λ―Όκ°λ„μ— λ”°λ¥Έ μ°¨λ“± λ³΄νΈ
2. **κ²€μƒ‰ κΈ°λ¥λ³„ μµμ  μ•”νΈν™” λ°©μ‹ μ„ μ •** - λ™λ“± κ²€μƒ‰, λ²”μ„ κ²€μƒ‰, λ¶€λ¶„ κ²€μƒ‰ λ“±
3. **μ„±λ¥κ³Ό λ³΄μ•μ κ· ν•μ  μΈ΅μ •** - λ‹¤μ–‘ν• μ‹λ‚λ¦¬μ¤μ—μ„μ λ²¤μΉλ§ν‚Ή

## β… λ‹¤μ λ‹¨κ³„

* Spring + JPA κΈ°λ° AES256 μ•”λ³µνΈν™” μλ™ν™” κµ¬μ΅° μ„¤κ³„
* Elasticsearch μ—°λ™μ„ κ³ λ ¤ν• κ²€μƒ‰ ν•„λ“ λ§μ¤ν‚Ή/κ°€λ…ν™” κµ¬μ΅° μ„¤κ³„
* λ‹¤μ–‘ν• μ•”νΈν™” λ°©μ‹μ— λ”°λ¥Έ μ„±λ¥ λ° κ²€μƒ‰ κ°€λ¥μ„± λΉ„κµ μ‹¤ν— μ§„ν–‰ μμ •
* μ•”νΈν™”λ μƒνƒμ—μ„μ λ¶€λ¶„ κ²€μƒ‰(LIKE κ²€μƒ‰) κµ¬ν„ λ°©μ• μ—°κµ¬